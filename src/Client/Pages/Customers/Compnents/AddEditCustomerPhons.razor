@using ErpDashboard.Application.Models;
@using ErpDashboard.Client.Infrastructure.Managers.Customers;
@using ErpDashboard.Application.Features.Customer.Command.AddEdit;
@using ErpDashboard.Application.Features.Customer.Quers.GetAllCustomers;
@using ErpDashboard.Client.Infrastructure.Mappings

<EditForm Model="Model"OnValidSubmit="Save">
	<FluentValidationValidator @ref="_fluentValidationValidator" />
    <MudDialog>
	<DialogContent>
		<MudCard Style="margin-bottom:30px">
			<MudCardHeader>
			<MudIcon Style="color:darkorange;font-size:3rem;padding-bottom:10px" Icon="@Icons.Filled.Phone"></MudIcon>
			<HeroTitle  Title="Customer Phons"></HeroTitle>
			</MudCardHeader>
			<MudCardContent>
					<MudSelect Variant="Variant.Outlined" For="@(() => Model.PhoneType)"  T="string" Label="Phone Type" AnchorOrigin="Origin.BottomCenter"@bind-Value="Model.PhoneType">
					<MudSelectItem Value="@("Mobile")" />
					<MudSelectItem Value="@("Work Phone")" />
					<MudSelectItem Value="@("Home Phone")" />
					<MudSelectItem Value="@("Other Phone")" />
				</MudSelect>
				<MudTextField  Immediate="true" Class="mt-8" For="@(() => Model.Phone)" @bind-Value="Model.Phone" Label="Phone" Variant="Variant.Outlined" />
			</MudCardContent>
			<MudCardActions>
				<MudButton FullWidth="true" OnClick="Save" Disabled="@(string.IsNullOrEmpty(Model.Phone) || string.IsNullOrEmpty(Model.PhoneType) )"   Variant="Variant.Filled" Style="margin-bottom:25px; height:50px; background-color:green;border-radius:7px;color:white">Save</MudButton>
			</MudCardActions>
		</MudCard>
	</DialogContent>
</MudDialog>

</EditForm>


@code {
	[Parameter] public CustomerPhoneClientDto Model { get; set; } = new();
	[CascadingParameter] MudDialogInstance MudDialog { get; set; }
	private FluentValidationValidator _fluentValidationValidator;
	
	private bool Validated => _fluentValidationValidator.Validate(options => { options.IncludeAllRuleSets(); });
	
	private  void Save()
	{
		
		if (Validated)
		{
			MudDialog.Close(Model);
		}
		
	}
}
